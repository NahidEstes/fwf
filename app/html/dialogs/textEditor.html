<link rel="stylesheet" type="text/css" href="../style.css">

<h2>Text editor</h2>

<div id="view">
    <div>
        <canvas id="canvas"></canvas>
    </div>
    <div>
        <div id="settings">
            <label>Text</label><br>
            <input id="text" value="Hello World"><br>
            <label>X</label><br>
            <input id="x" value=0 type="number"><br>
            <label>Y</label><br>
            <input id="y" value=50 type="number"><br>
            <label>Color</label><br>
            <input id="color" value="white"><br>
            <label>Size</label><br>
            <input id="size" value=30 type="number"><br>
            <label>Font</label><br>
            <input id="font" value="serif"><br>
        </div>
        <a class="toolButton" onclick="add()">Add text</a>
    </div>
</div>

<style>
#view {
    display: flex;
}
#view > div {
    flex: 1;
    margin-left: 20px;
}
h3 {
    margin: 0;
}
h2 {
    margin: 10px;
}
a {
    cursor: pointer;
}
</style>

<script>
const {ipcRenderer, clipboard} = require('electron');
var ctx = document.getElementById('canvas').getContext('2d');

window.addEventListener("keyup", redraw)
window.addEventListener("mouseup", redraw)

var img = new Image();
img.src = '../res/sample.jpg';

var h = 400;
var w = 600;
setDimensions();

function getVal(id) {
    return document.getElementById(id).value;
}

function setDimensions() {
    var canvas = document.getElementById('canvas');
    canvas.height = h;
    canvas.width = w;
}

function redraw() {
    ctx.drawImage(img, 0, 0, w, h)
    ctx.fillStyle = getVal("color")
    ctx.font = getVal("size") + "px " + getVal("font");
    ctx.fillText(getVal("text"), getVal("x"), getVal("y"))
}

function loadTemplate(name) {
    editor.set(templates[name])
}

function fromClipboard() {
    editor.setText(clipboard.readText())
}

function add() {
    ipcRenderer.send("toMainWindow", {
        channel: "addFilter",
        value: editor.get(),
    });
}
</script>
